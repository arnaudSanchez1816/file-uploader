{"version":3,"file":"folder.min.js","sources":["../../js/folder.js?commonjs-entry","../../js/folder.js","../../js/fileDetailsDialog.js","../../js/dragAndDrop.js"],"sourcesContent":["import { getDefaultExportFromCjs } from \"\u0000commonjsHelpers.js\";\nimport { __require as requireFolder } from \"/home/asanchez/Work/OdinProject/React-path/Node/file-uploader/js/folder.js\";\nvar folderExports = requireFolder();\nexport { folderExports as __moduleExports };\nexport default /*@__PURE__*/getDefaultExportFromCjs(folderExports);","const FileDetailsDialog = require(\"./fileDetailsDialog\")\nconst { parseBigInt } = require(\"./helpers\")\nrequire(\"./dragAndDrop\")\n\nconst files = parseBigInt(document.querySelector(\"#files-data\").textContent)\nconst fileDetails = new FileDetailsDialog(\"#file-details-dialog\")\n\nconst filesButtons = [...document.querySelectorAll(\"button.file\")]\n\nfilesButtons.forEach((btn) => {\n    btn.addEventListener(\"click\", () => {\n        const fileId = btn.dataset.id\n        if (!fileId) {\n            throw new Error(`No id specified for this file button (${btn}).`)\n        }\n        const file = files.filter((file) => file.id === +fileId)[0]\n        fileDetails.showFile(file)\n    })\n})\n","class FileDetailsDialog {\n    #dialog\n\n    constructor(htmlElement) {\n        if (htmlElement instanceof HTMLElement) {\n            this.#dialog = htmlElement\n        } else {\n            this.#dialog = document.querySelector(htmlElement)\n        }\n\n        if (!this.#dialog) {\n            throw new Error(\n                \"File details dialog element provided is undefined or null.\"\n            )\n        }\n    }\n\n    showFile({ id, name, createdAt, size }) {\n        if (!this.#dialog) {\n            console.error(\"File details dialog element is invalid !\")\n            return\n        }\n\n        const dialog = this.#dialog\n\n        const fileNames = [...dialog.querySelectorAll(\".file-name\")]\n        fileNames.forEach((element) => (element.textContent = name))\n\n        const fileSizes = [...dialog.querySelectorAll(\".file-size\")]\n        fileSizes.forEach((element) => (element.textContent = size))\n\n        const fileCreated = [...dialog.querySelectorAll(\".file-created\")]\n        fileCreated.forEach((element) => (element.textContent = createdAt))\n\n        const downloadLink = dialog.querySelector(\"a.download\")\n        downloadLink.href = `/files/${id}`\n\n        const deleteForm = dialog.querySelector(\"form.delete\")\n        deleteForm.action = `/files/${id}?_method=DELETE`\n\n        dialog.showModal()\n    }\n}\n\nmodule.exports = FileDetailsDialog\n","// Create an image and use it for the drag image\n// Use the image URL that you desire\nconst folderDragImg = new Image()\nfolderDragImg.src = \"/img/mdi--folder-move-outline.png\"\n\nconst dragTargets = [\n    ...document.querySelectorAll(\".drag-target[draggable=true]\"),\n]\n\nconst dropTargets = document.querySelectorAll(\".drop-target\")\n\nfunction toggleDragTargets(enabled) {\n    for (const target of dropTargets) {\n        target.classList.toggle(\"hidden\", !enabled)\n    }\n}\n\ndragTargets.forEach((folder) => {\n    folder.addEventListener(\"dragstart\", (ev) => {\n        ev.dataTransfer.setData(\"text/plain\", ev.target.dataset.id)\n        ev.dataTransfer.setData(\n            \"application/action-type\",\n            ev.target.classList.contains(\"file\") ? \"files\" : \"folders\"\n        )\n        ev.dataTransfer.effectAllowed = \"move\"\n        ev.dataTransfer.dropEffect = \"move\"\n        ev.dataTransfer.setDragImage(folderDragImg, 28, 22)\n        toggleDragTargets(true)\n    })\n\n    folder.addEventListener(\"dragend\", () => {\n        toggleDragTargets(false)\n    })\n})\n\nfor (const target of dropTargets) {\n    target.addEventListener(\"dragover\", (ev) => {\n        console.log(ev.dataTransfer.dropEffect)\n        ev.preventDefault()\n        const targetId = ev.dataTransfer.getData(\"text/plain\")\n        const dropId = ev.target.dataset.id\n        ev.dataTransfer.dropEffect = targetId !== dropId ? \"move\" : \"none\"\n    })\n    target.addEventListener(\"dragenter\", (ev) => {\n        ev.preventDefault()\n        const targetId = ev.dataTransfer.getData(\"text/plain\")\n        const dropId = ev.target.dataset.id\n        ev.dataTransfer.dropEffect = targetId !== dropId ? \"move\" : \"none\"\n\n        if (ev.dataTransfer.dropEffect === \"move\") {\n            target.classList.add(\"outline-dashed\")\n        }\n    })\n    target.addEventListener(\"dragleave\", (ev) => {\n        ev.preventDefault()\n        target.classList.remove(\"outline-dashed\")\n    })\n\n    target.addEventListener(\"drop\", (ev) => {\n        ev.preventDefault()\n\n        const data = ev.dataTransfer.getData(\"text/plain\")\n        const actionType = ev.dataTransfer.getData(\"application/action-type\")\n        target.classList.remove(\"outline-dashed\")\n        const form = document.createElement(\"form\")\n        form.action = `/${actionType}/${data}/move`\n        form.method = \"POST\"\n        const newParentInput = document.createElement(\"input\")\n        newParentInput.type = \"hidden\"\n        newParentInput.name = \"newParentId\"\n        newParentInput.value = ev.target.dataset.id\n        form.append(newParentInput)\n        document.body.append(form)\n        form.submit()\n    })\n}\n"],"names":["folderExports","FileDetailsDialog","fileDetailsDialog","dialog","constructor","htmlElement","HTMLElement","this","document","querySelector","Error","showFile","id","name","createdAt","size","console","error","querySelectorAll","forEach","element","textContent","href","action","showModal","parseBigInt","require$$1","folderDragImg","Image","src","dragTargets","dropTargets","toggleDragTargets","enabled","target","classList","toggle","folder","addEventListener","ev","dataTransfer","setData","dataset","contains","effectAllowed","dropEffect","setDragImage","log","preventDefault","targetId","getData","dropId","add","remove","data","actionType","form","createElement","method","newParentInput","type","value","append","body","submit","require$$2","files","fileDetails","btn","fileId","file","filter","requireFolder","getDefaultExportFromCjs"],"mappings":"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"}